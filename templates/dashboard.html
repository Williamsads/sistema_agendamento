{% extends "base.html" %}

{% block content %}
<div style="text-align: center; margin-bottom: 4rem;">
    <h1>Painel de Ocupação</h1>
    <p class="subtitle">Acompanhe em tempo real a disponibilidade das salas de reunião do 4º Andar.</p>
</div>

<div class="rooms-grid">
    {% for sala in status_salas %}
    <div class="room-card {{ 'busy' if sala.ocupada else 'free' }}">
        <div class="room-header">
            <span class="room-number">{{ sala.info.nome }}</span>
            <span class="badge {{ 'badge-busy' if sala.ocupada else 'badge-free' }}">
                {{ 'Ocupada' if sala.ocupada else 'Disponível' }}
            </span>
        </div>

        <div class="room-details">
            <div class="detail-item">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                </svg>
                {{ sala.info.andar }}
            </div>

            {% if sala.ocupada and sala.reserva_atual %}
            <div class="detail-item">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                <strong>Responsável:</strong> {{ sala.reserva_atual.nome_solicitante }}
            </div>
            <div class="detail-item">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <strong>Assunto:</strong> {{ sala.reserva_atual.assunto }}
            </div>
            <div class="detail-item">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                <strong>Até:</strong> {{ sala.reserva_atual.hora_fim.strftime('%H:%M') }}
            </div>
            {% else %}
            <div
                style="margin-top: 1rem; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center; border: 1px dashed #cbd5e1;">
                <span style="color: var(--text-muted); font-size: 0.85rem;">Nenhuma reunião em andamento</span>
            </div>
            {% endif %}
        </div>

        <a href="{{ url_for('reservar', sala_id=sala.info.id) }}"
            class="btn {{ 'btn-ghost' if sala.ocupada else 'btn-primary' }}" style="width: 100%;">
            {{ 'Ver Agendamentos' if sala.ocupada else 'Reservar Agora' }}
        </a>
    </div>
    {% endfor %}
</div>
{% endblock %}